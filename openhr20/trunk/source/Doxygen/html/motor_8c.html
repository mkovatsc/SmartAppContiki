<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>HR20: motor.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>motor.c File Reference</h1>functions to control the HR20 motor <a href="#_details">More...</a>
<p>
<code>#include &lt;stdint.h&gt;</code><br>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;avr/interrupt.h&gt;</code><br>
<code>#include &lt;avr/pgmspace.h&gt;</code><br>
<code>#include &lt;avr/sleep.h&gt;</code><br>
<code>#include &lt;avr/version.h&gt;</code><br>
<code>#include &quot;<a class="el" href="main_8h.html">main.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="motor_8h.html">motor.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="lcd_8h.html">lcd.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for motor.c:</div>
<div class="dynsection">
<p><center><img src="motor_8c__incl.png" border="0" usemap="#motor.c_map" alt=""></center>
<map name="motor.c_map">
<area shape="rect" href="main_8h.html" title="header file for main.c, the main file for Open HR20 project" alt="" coords="659,80,717,107"><area shape="rect" href="motor_8h.html" title="header file for motor.c, functions to control the HR20 motor" alt="" coords="741,80,805,107"><area shape="rect" href="lcd_8h.html" title="header file for lcd.c, functions to control the HR20 LCD" alt="" coords="829,80,877,107"></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a64c6dce15e9de9105b4ae9533c9a267">ISR</a> (PCINT0_vect)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#ef1e0dd60d2e2c08eb59034594b08cdd">MOTOR_Calibrate</a> (uint8_t percent, <a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a> speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#96b1380b69083a1895562802095659fc">MOTOR_CheckBlocked</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414">MOTOR_Control</a> (<a class="el" href="motor_8h.html#1d59daf0cf17c97fd264eea7b6d43760">motor_dir_t</a> direction, <a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a> speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#76a56a08989fb24dd2157929c7632c78">MOTOR_GetPosPercent</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#6fe673d720109d2ec9f2e2af880772e6">MOTOR_Goto</a> (uint8_t percent, <a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a> speed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#9b3a7f55576e8e8d5747c3ee4c1d960b">MOTOR_Init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#9eae710e953801f265485b36a3e7b7f2">MOTOR_IsCalibrated</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#bc86f421f2ea71af9abcf1a117689129">MOTOR_On</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#505290d7e4886b8dfb5b30c96cb409e3">MOTOR_ResetCalibration</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#dfdf265cdca9dc4cda456545983c0b03">MOTOR_SetMountStatus</a> (<a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#51449925d31e63b0d2bc7a3d486dc4e7">MOTOR_Stop</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile <a class="el" href="motor_8h.html#1d59daf0cf17c97fd264eea7b6d43760">motor_dir_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#83c0b3706cfc2f9c10b217a203abec6f">MOTOR_Dir</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">actual direction  <a href="#83c0b3706cfc2f9c10b217a203abec6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile <a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#fd29ed63f129c3547f5e96bae6e465a4">MOTOR_mounted</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">mountstatus true: if valve is mounted  <a href="#fd29ed63f129c3547f5e96bae6e465a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#2b9fe6b4492987bc3162782fdc4235e5">MOTOR_PosAct</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">actual position  <a href="#2b9fe6b4492987bc3162782fdc4235e5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#0b4a832804b4e2579df4481766a49f84">MOTOR_PosLast</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">last position for check if blocked  <a href="#0b4a832804b4e2579df4481766a49f84"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#323b66ab47f411faa8e2dc205e4c5531">MOTOR_PosMax</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#f48b0e0969efd9c50c68ac8f569e09ed">MOTOR_PosStop</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">stop at this position  <a href="#f48b0e0969efd9c50c68ac8f569e09ed"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
functions to control the HR20 motor 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Dario Carluccio &lt;hr20-at-carluccio-dot-de&gt; </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>08.02.2008 </dd></dl>
<dl class="rcs" compact><dt><b>Rev</b></dt><dd>112 </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a64c6dce15e9de9105b4ae9533c9a267"></a><!-- doxytag: member="motor.c::ISR" ref="a64c6dce15e9de9105b4ae9533c9a267" args="(PCINT0_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">PCINT0_vect&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pinchange Interupt INT0<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>count light eye impulss: <a class="el" href="motor_8c.html#2b9fe6b4492987bc3162782fdc4235e5">MOTOR_PosAct</a><p>
stops the motor if <a class="el" href="motor_8c.html#f48b0e0969efd9c50c68ac8f569e09ed">MOTOR_PosStop</a> is reached </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_a64c6dce15e9de9105b4ae9533c9a267_cgraph.png" border="0" usemap="#motor_8c_a64c6dce15e9de9105b4ae9533c9a267_cgraph_map" alt=""></center>
<map name="motor_8c_a64c6dce15e9de9105b4ae9533c9a267_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="97,5,212,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="ef1e0dd60d2e2c08eb59034594b08cdd"></a><!-- doxytag: member="motor.c::MOTOR_Calibrate" ref="ef1e0dd60d2e2c08eb59034594b08cdd" args="(uint8_t percent, motor_speed_t speed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> MOTOR_Calibrate           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>percent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a>&nbsp;</td>
          <td class="paramname"> <em>speed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
calibrate the motor and drive it to position in percent \ returns<ul>
<li>true if calibration successfull</li><li>false if not successfull possible reasons:<ul>
<li>motor is not stopped after <a class="el" href="motor_8h.html#38025739e402abddacdcba152c8e1ead">MOTOR_MAX_IMPULSES</a> impulses</li><li>motor has been dismounted</li></ul>
</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>percent</em>&nbsp;</td><td>desired position after calibration 0-100<ul>
<li>0 : closed</li><li>100 : open</li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>motorspeed in percent for PWM</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>minimises motor time (save power) </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_cgraph.png" border="0" usemap="#motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_cgraph_map" alt=""></center>
<map name="motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_cgraph_map">
<area shape="rect" href="main_8c.html#13e6735ac2ce9a696565583b47898384" title="delay" alt="" coords="208,6,259,32"><area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="335,82,449,108"><area shape="rect" href="motor_8c.html#6fe673d720109d2ec9f2e2af880772e6" title="MOTOR_Goto" alt="" coords="181,107,285,134"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_icgraph.png" border="0" usemap="#motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_icgraph_map" alt=""></center>
<map name="motor_8c_ef1e0dd60d2e2c08eb59034594b08cdd_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="183,5,231,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="96b1380b69083a1895562802095659fc"></a><!-- doxytag: member="motor.c::MOTOR_CheckBlocked" ref="96b1380b69083a1895562802095659fc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_CheckBlocked           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
check if motor is blocked<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>stops the motor if blocked<p>
checks if <a class="el" href="motor_8c.html#2b9fe6b4492987bc3162782fdc4235e5">MOTOR_PosAct</a> == <a class="el" href="motor_8c.html#0b4a832804b4e2579df4481766a49f84">MOTOR_PosLast</a><p>
must be called at least every 1s <br>
 not quicker than 500ms </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_96b1380b69083a1895562802095659fc_cgraph.png" border="0" usemap="#motor_8c_96b1380b69083a1895562802095659fc_cgraph_map" alt=""></center>
<map name="motor_8c_96b1380b69083a1895562802095659fc_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="215,5,329,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_96b1380b69083a1895562802095659fc_icgraph.png" border="0" usemap="#motor_8c_96b1380b69083a1895562802095659fc_icgraph_map" alt=""></center>
<map name="motor_8c_96b1380b69083a1895562802095659fc_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="215,5,263,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5a586d18f7747ef180cd41bdf16bb414"></a><!-- doxytag: member="motor.c::MOTOR_Control" ref="5a586d18f7747ef180cd41bdf16bb414" args="(motor_dir_t direction, motor_speed_t speed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_Control           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="motor_8h.html#1d59daf0cf17c97fd264eea7b6d43760">motor_dir_t</a>&nbsp;</td>
          <td class="paramname"> <em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a>&nbsp;</td>
          <td class="paramname"> <em>speed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
controll motor movement<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>direction</em>&nbsp;</td><td>motordirection<ul>
<li>stop</li><li>ope</li><li>close</li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>motorspeed<ul>
<li>full (MOTOR_FULL_PWM /100) * 255</li><li>quiet (MOTOR_QUIET_PWM /100) * 255</li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>motorspeed in percent for PWM</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>PWM runs at 15,625 kHz<p>
Output for direction: <div class="fragment"><pre class="fragment">
     direction  PG3  PG4  PB7  PB4/PWM(OC0A)    PE3    PCINT4
       stop:     0    0    0    0                0      off
       open:     0    1    1   invert. mode      1      on
       close:    1    0    0   non inv mode      1      on       </pre></div> </dd></dl>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_5a586d18f7747ef180cd41bdf16bb414_icgraph.png" border="0" usemap="#motor_8c_5a586d18f7747ef180cd41bdf16bb414_icgraph_map" alt=""></center>
<map name="motor_8c_5a586d18f7747ef180cd41bdf16bb414_icgraph_map">
<area shape="rect" href="motor_8c.html#a64c6dce15e9de9105b4ae9533c9a267" title="ISR" alt="" coords="235,5,277,32"><area shape="rect" href="motor_8h.html#0a97a2be98ced5e2dab26281245c294f" title="MOTOR_Calibrate" alt="" coords="412,106,537,133"><area shape="rect" href="motor_8h.html#96b1380b69083a1895562802095659fc" title="MOTOR_CheckBlocked" alt="" coords="395,56,555,82"><area shape="rect" href="motor_8h.html#837570ff869365284fb6d010ac729f3e" title="MOTOR_Goto" alt="" coords="204,157,308,184"><area shape="rect" href="motor_8h.html#9b3a7f55576e8e8d5747c3ee4c1d960b" title="MOTOR_Init" alt="" coords="211,208,301,234"><area shape="rect" href="motor_8h.html#505290d7e4886b8dfb5b30c96cb409e3" title="MOTOR_ResetCalibration" alt="" coords="171,258,341,285"><area shape="rect" href="motor_8h.html#51449925d31e63b0d2bc7a3d486dc4e7" title="MOTOR_Stop" alt="" coords="205,309,307,336"><area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="609,157,657,184"><area shape="rect" href="main_8c.html#2858154e2009b0e6e616f313177762bc" title="init" alt="" coords="456,208,493,234"><area shape="rect" href="motor_8h.html#03aca69e163c1cafcd9f9dc6ecf8f721" title="MOTOR_SetMountStatus" alt="" coords="391,258,559,285"></map>
</div>

</div>
</div><p>
<a class="anchor" name="76a56a08989fb24dd2157929c7632c78"></a><!-- doxytag: member="motor.c::MOTOR_GetPosPercent" ref="76a56a08989fb24dd2157929c7632c78" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t MOTOR_GetPosPercent           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>actual position of motor in percent</li><li>255 if motor is not calibrated </li></ul>
</dd></dl>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_76a56a08989fb24dd2157929c7632c78_icgraph.png" border="0" usemap="#motor_8c_76a56a08989fb24dd2157929c7632c78_icgraph_map" alt=""></center>
<map name="motor_8c_76a56a08989fb24dd2157929c7632c78_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="220,5,268,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="6fe673d720109d2ec9f2e2af880772e6"></a><!-- doxytag: member="motor.c::MOTOR_Goto" ref="6fe673d720109d2ec9f2e2af880772e6" args="(uint8_t percent, motor_speed_t speed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> MOTOR_Goto           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>percent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="motor_8h.html#cab936c5b4eacfaf53192c4eac1e071e">motor_speed_t</a>&nbsp;</td>
          <td class="paramname"> <em>speed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
drive motor to desired position in percent <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>percent</em>&nbsp;</td><td>desired endposition 0-100<ul>
<li>0 : closed</li><li>100 : open </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>motorspeed in percent for PWM</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>works only if calibrated before </dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_6fe673d720109d2ec9f2e2af880772e6_cgraph.png" border="0" usemap="#motor_8c_6fe673d720109d2ec9f2e2af880772e6_cgraph_map" alt=""></center>
<map name="motor_8c_6fe673d720109d2ec9f2e2af880772e6_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="159,5,273,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_6fe673d720109d2ec9f2e2af880772e6_icgraph.png" border="0" usemap="#motor_8c_6fe673d720109d2ec9f2e2af880772e6_icgraph_map" alt=""></center>
<map name="motor_8c_6fe673d720109d2ec9f2e2af880772e6_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="335,6,383,32"><area shape="rect" href="motor_8h.html#0a97a2be98ced5e2dab26281245c294f" title="MOTOR_Calibrate" alt="" coords="159,31,284,58"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9b3a7f55576e8e8d5747c3ee4c1d960b"></a><!-- doxytag: member="motor.c::MOTOR_Init" ref="9b3a7f55576e8e8d5747c3ee4c1d960b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_Init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Init motor<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>configure pwm</li><li>stop motor</li><li>init values </li></ul>
</dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_cgraph.png" border="0" usemap="#motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_cgraph_map" alt=""></center>
<map name="motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="148,5,263,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_icgraph.png" border="0" usemap="#motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_icgraph_map" alt=""></center>
<map name="motor_8c_9b3a7f55576e8e8d5747c3ee4c1d960b_icgraph_map">
<area shape="rect" href="main_8c.html#2858154e2009b0e6e616f313177762bc" title="init" alt="" coords="148,5,185,32"><area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="236,5,284,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9eae710e953801f265485b36a3e7b7f2"></a><!-- doxytag: member="motor.c::MOTOR_IsCalibrated" ref="9eae710e953801f265485b36a3e7b7f2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> MOTOR_IsCalibrated           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>true: calibration finished succesfully</li><li>false: motor is not calibrated </li></ul>
</dd></dl>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_9eae710e953801f265485b36a3e7b7f2_icgraph.png" border="0" usemap="#motor_8c_9eae710e953801f265485b36a3e7b7f2_icgraph_map" alt=""></center>
<map name="motor_8c_9eae710e953801f265485b36a3e7b7f2_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="199,5,247,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="bc86f421f2ea71af9abcf1a117689129"></a><!-- doxytag: member="motor.c::MOTOR_On" ref="bc86f421f2ea71af9abcf1a117689129" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> MOTOR_On           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>true: motor is on</li><li>false: motor is off </li></ul>
</dd></dl>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_bc86f421f2ea71af9abcf1a117689129_icgraph.png" border="0" usemap="#motor_8c_bc86f421f2ea71af9abcf1a117689129_icgraph_map" alt=""></center>
<map name="motor_8c_bc86f421f2ea71af9abcf1a117689129_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="148,5,196,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="505290d7e4886b8dfb5b30c96cb409e3"></a><!-- doxytag: member="motor.c::MOTOR_ResetCalibration" ref="505290d7e4886b8dfb5b30c96cb409e3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_ResetCalibration           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reset calibration data<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>must be called if the motor is unmounted </li></ul>
</dd></dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_505290d7e4886b8dfb5b30c96cb409e3_cgraph.png" border="0" usemap="#motor_8c_505290d7e4886b8dfb5b30c96cb409e3_cgraph_map" alt=""></center>
<map name="motor_8c_505290d7e4886b8dfb5b30c96cb409e3_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="225,5,340,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_505290d7e4886b8dfb5b30c96cb409e3_icgraph.png" border="0" usemap="#motor_8c_505290d7e4886b8dfb5b30c96cb409e3_icgraph_map" alt=""></center>
<map name="motor_8c_505290d7e4886b8dfb5b30c96cb409e3_icgraph_map">
<area shape="rect" href="motor_8h.html#03aca69e163c1cafcd9f9dc6ecf8f721" title="MOTOR_SetMountStatus" alt="" coords="225,5,393,32"><area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="444,5,492,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="dfdf265cdca9dc4cda456545983c0b03"></a><!-- doxytag: member="motor.c::MOTOR_SetMountStatus" ref="dfdf265cdca9dc4cda456545983c0b03" args="(bool value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_SetMountStatus           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a>&nbsp;</td>
          <td class="paramname"> <em>value</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the actual status for the motor <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td><ul>
<li>true: motor is mounted to valve</li><li>false: motor is not mounted </li></ul>
</td></tr>
  </table>
</dl>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_dfdf265cdca9dc4cda456545983c0b03_cgraph.png" border="0" usemap="#motor_8c_dfdf265cdca9dc4cda456545983c0b03_cgraph_map" alt=""></center>
<map name="motor_8c_dfdf265cdca9dc4cda456545983c0b03_cgraph_map">
<area shape="rect" href="motor_8c.html#505290d7e4886b8dfb5b30c96cb409e3" title="MOTOR_ResetCalibration" alt="" coords="224,5,395,32"><area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="444,5,559,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_dfdf265cdca9dc4cda456545983c0b03_icgraph.png" border="0" usemap="#motor_8c_dfdf265cdca9dc4cda456545983c0b03_icgraph_map" alt=""></center>
<map name="motor_8c_dfdf265cdca9dc4cda456545983c0b03_icgraph_map">
<area shape="rect" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe" title="main" alt="" coords="225,5,273,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="51449925d31e63b0d2bc7a3d486dc4e7"></a><!-- doxytag: member="motor.c::MOTOR_Stop" ref="51449925d31e63b0d2bc7a3d486dc4e7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MOTOR_Stop           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
stop the motor 
<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="motor_8c_51449925d31e63b0d2bc7a3d486dc4e7_cgraph.png" border="0" usemap="#motor_8c_51449925d31e63b0d2bc7a3d486dc4e7_cgraph_map" alt=""></center>
<map name="motor_8c_51449925d31e63b0d2bc7a3d486dc4e7_cgraph_map">
<area shape="rect" href="motor_8c.html#5a586d18f7747ef180cd41bdf16bb414" title="MOTOR_Control" alt="" coords="159,5,273,32"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="83c0b3706cfc2f9c10b217a203abec6f"></a><!-- doxytag: member="motor.c::MOTOR_Dir" ref="83c0b3706cfc2f9c10b217a203abec6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="motor_8h.html#1d59daf0cf17c97fd264eea7b6d43760">motor_dir_t</a> <a class="el" href="motor_8c.html#83c0b3706cfc2f9c10b217a203abec6f">MOTOR_Dir</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
actual direction 
<p>

</div>
</div><p>
<a class="anchor" name="fd29ed63f129c3547f5e96bae6e465a4"></a><!-- doxytag: member="motor.c::MOTOR_mounted" ref="fd29ed63f129c3547f5e96bae6e465a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="main_8h.html#f6a258d8f3ee5206d682d799316314b1">bool</a> <a class="el" href="motor_8c.html#fd29ed63f129c3547f5e96bae6e465a4">MOTOR_mounted</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
mountstatus true: if valve is mounted 
<p>

</div>
</div><p>
<a class="anchor" name="2b9fe6b4492987bc3162782fdc4235e5"></a><!-- doxytag: member="motor.c::MOTOR_PosAct" ref="2b9fe6b4492987bc3162782fdc4235e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="motor_8c.html#2b9fe6b4492987bc3162782fdc4235e5">MOTOR_PosAct</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
actual position 
<p>

</div>
</div><p>
<a class="anchor" name="0b4a832804b4e2579df4481766a49f84"></a><!-- doxytag: member="motor.c::MOTOR_PosLast" ref="0b4a832804b4e2579df4481766a49f84" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="motor_8c.html#0b4a832804b4e2579df4481766a49f84">MOTOR_PosLast</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
last position for check if blocked 
<p>

</div>
</div><p>
<a class="anchor" name="323b66ab47f411faa8e2dc205e4c5531"></a><!-- doxytag: member="motor.c::MOTOR_PosMax" ref="323b66ab47f411faa8e2dc205e4c5531" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="motor_8c.html#323b66ab47f411faa8e2dc205e4c5531">MOTOR_PosMax</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
position if complete open (100%) <br>
 0 if not calibrated 
</div>
</div><p>
<a class="anchor" name="f48b0e0969efd9c50c68ac8f569e09ed"></a><!-- doxytag: member="motor.c::MOTOR_PosStop" ref="f48b0e0969efd9c50c68ac8f569e09ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="motor_8c.html#f48b0e0969efd9c50c68ac8f569e09ed">MOTOR_PosStop</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
stop at this position 
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Mar 1 00:45:05 2008 for HR20 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
